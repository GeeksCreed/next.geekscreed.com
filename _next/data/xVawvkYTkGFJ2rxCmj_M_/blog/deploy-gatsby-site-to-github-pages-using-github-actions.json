{"pageProps":{"post":{"title":"Deploy Gatsby Site to GitHub Pages using GitHub Actions","published_at":"Dec 3, 2019","slug":"deploy-gatsby-site-to-github-pages-using-github-actions","authors":[{"id":"sasivarnan","name":"Sasivarnan R","bio":"Software Engineer. Tech Enthusiast. Loves coding ðŸ’» and music ðŸŽ¼.","location":"India","website":"https://geekscreed.com","twitter":"iamsasivarnan","linkedin":"sasivarnan","profile_image":"https://avatars0.githubusercontent.com/u/5305600?v=4","cover_image":""}],"content":"<p>We are seeing an increase in the popularity of <a href=\"https://jamstack.org/\">JAMStack</a>. <a href=\"https://www.gatsbyjs.org/\">Gatsby</a> is one of the popular JAMStack frameworks.</p>\n<p>There are a lot of tools and services available to host a static site build by Gatsby. <a href=\"https://pages.github.com/\">GitHub Pages</a>, a free static site hosting service by GitHub, is one of them.</p>\n<p>In this article, we will see how to build and deploy your existing Gatsby site using <a href=\"https://github.com/features/actions\">GitHub Actions</a> on every push to GitHub repo where your site is stored.</p>\n<ul>\n<li>\n<p>In your <code>package.json</code> file, add a build script pointing to <code>gatsby build</code> (Most starters will already have it).</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"gatsby build\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n</li>\n<li>\n<p>Create a GitHub access token by following the steps over <a href=\"https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line\">here</a>. Please note that the token must be generated with repo permissions.</p>\n</li>\n<li>\n<p>Open your GitHub repo settings, and go to the <code>Secrets</code> section. Click on <code>Add a new secret</code>. Fill <code>ACCESS_TOKEN</code> in the <code>Name</code> field and fill your generated access token from the previous step in the <code>Value</code> field. Click on the <code>Add secret</code> button.</p>\n</li>\n</ul>\n<p><img src=\"./GitHub-Add_a_new_secret_form.png\" alt=\"GitHub Add a new secret form\" title=\"GitHub Add a new secret form\"></p>\n<ul>\n<li>\n<p>Now, create a yml file in following path <code>.github/workflows/deploy-on-push.yml</code> and paste the following contents to it.</p>\n<pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Gatsby Build and Deploy to GitHub Pages on Push\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> master\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@master\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build and Deploy\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> JamesIves/github<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>deploy<span class=\"token punctuation\">-</span>action@master\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">ACCESS_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ACCESS_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">BRANCH</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages\n          <span class=\"token key atrule\">FOLDER</span><span class=\"token punctuation\">:</span> public\n          <span class=\"token key atrule\">BUILD_SCRIPT</span><span class=\"token punctuation\">:</span> yarn <span class=\"token important\">&#x26;&#x26;</span> yarn run build\n</code></pre>\n</li>\n<li>\n<p>Commit your changes and push them to your GitHub repo.</p>\n</li>\n</ul>\n<p>This GitHub action will trigger if any push happened to master, spawns a ubuntu instance and check out the repo. Then it will do <code>yarn</code> and <code>yarn build</code>, which will generate the output to <code>public</code> directory. The contents of the public folder will be deployed to <code>gh-pages</code> branch.</p>\n<p>Now on every push to your repo will build your site and deploy it to GitHub pages.</p>\n<p>I hope this helped you to set up the deployment of Gatsby site to GitHub Pages using GitHub actions. Feel free to ask anything around this in the comments section below.</p>","excerpt":"\nWe are seeing an increase in the popularity of [JAMStack](https://jamstack.org/). [Gatsby](https://www.gatsbyjs.org/) is one of the popular","feature_image":"/images/blog/ship-it.jpg","primary_tag":{"id":"gatsby","name":"Gatsby","slug":"gatsby","description":"Articles around Gatsby","feature_image":""},"tags":["gatsby","web-dev","github"]},"tags":[{"id":"gatsby","name":"Gatsby","slug":"gatsby","description":"Articles around Gatsby","feature_image":""},{"id":"web-dev","name":"Web Development","slug":"web-dev","description":"Articles around Web Development","feature_image":""},{"id":"github","name":"GitHub","slug":"github","description":"Articles around GitHub","feature_image":""}]},"__N_SSG":true}